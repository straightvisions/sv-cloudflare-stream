/*! For license information please see block.build.js.LICENSE.txt */
(()=>{var e={184:(e,t)=>{var r;!function(){"use strict";var n={}.hasOwnProperty;function o(){for(var e=[],t=0;t<arguments.length;t++){var r=arguments[t];if(r){var i=typeof r;if("string"===i||"number"===i)e.push(r);else if(Array.isArray(r)){if(r.length){var a=o.apply(null,r);a&&e.push(a)}}else if("object"===i)if(r.toString===Object.prototype.toString)for(var s in r)n.call(r,s)&&r[s]&&e.push(s);else e.push(r.toString())}}return e.join(" ")}e.exports?(o.default=o,e.exports=o):void 0===(r=function(){return o}.apply(t,[]))||(e.exports=r)}()},575:function(e,t,r){var n,o;o="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==r.g?r.g:this,e.exports=function(r){"use strict";var o,i=(r=r||{}).Base64,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=function(e){for(var t={},r=0,n=e.length;r<n;r++)t[e.charAt(r)]=r;return t}(a),l=String.fromCharCode,u=function(e){if(e.length<2)return(t=e.charCodeAt(0))<128?e:t<2048?l(192|t>>>6)+l(128|63&t):l(224|t>>>12&15)+l(128|t>>>6&63)+l(128|63&t);var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return l(240|t>>>18&7)+l(128|t>>>12&63)+l(128|t>>>6&63)+l(128|63&t)},c=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,p=function(e){return e.replace(c,u)},f=function(e){var t=[0,2,1][e.length%3],r=e.charCodeAt(0)<<16|(e.length>1?e.charCodeAt(1):0)<<8|(e.length>2?e.charCodeAt(2):0);return[a.charAt(r>>>18),a.charAt(r>>>12&63),t>=2?"=":a.charAt(r>>>6&63),t>=1?"=":a.charAt(63&r)].join("")},d=r.btoa&&"function"==typeof r.btoa?function(e){return r.btoa(e)}:function(e){if(e.match(/[^\x00-\xFF]/))throw new RangeError("The string contains invalid characters.");return e.replace(/[\s\S]{1,3}/g,f)},h=function(e){return d(p(String(e)))},m=function(e){return e.replace(/[+\/]/g,(function(e){return"+"==e?"-":"_"})).replace(/=/g,"")},y=function(e,t){return t?m(h(e)):h(e)};r.Uint8Array&&(o=function(e,t){for(var r="",n=0,o=e.length;n<o;n+=3){var i=e[n],s=e[n+1],l=e[n+2],u=i<<16|s<<8|l;r+=a.charAt(u>>>18)+a.charAt(u>>>12&63)+(void 0!==s?a.charAt(u>>>6&63):"=")+(void 0!==l?a.charAt(63&u):"=")}return t?m(r):r});var v,g=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,b=function(e){switch(e.length){case 4:var t=((7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3))-65536;return l(55296+(t>>>10))+l(56320+(1023&t));case 3:return l((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return l((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},_=function(e){return e.replace(g,b)},w=function(e){var t=e.length,r=t%4,n=(t>0?s[e.charAt(0)]<<18:0)|(t>1?s[e.charAt(1)]<<12:0)|(t>2?s[e.charAt(2)]<<6:0)|(t>3?s[e.charAt(3)]:0),o=[l(n>>>16),l(n>>>8&255),l(255&n)];return o.length-=[0,0,2,1][r],o.join("")},S=r.atob&&"function"==typeof r.atob?function(e){return r.atob(e)}:function(e){return e.replace(/\S{1,4}/g,w)},E=function(e){return S(String(e).replace(/[^A-Za-z0-9\+\/]/g,""))},U=function(e){return String(e).replace(/[-_]/g,(function(e){return"-"==e?"+":"/"})).replace(/[^A-Za-z0-9\+\/]/g,"")},P=function(e){return function(e){return _(S(e))}(U(e))};r.Uint8Array&&(v=function(e){return Uint8Array.from(E(U(e)),(function(e){return e.charCodeAt(0)}))});if(r.Base64={VERSION:"2.6.4",atob:E,btoa:d,fromBase64:P,toBase64:y,utob:p,encode:y,encodeURI:function(e){return y(e,!0)},btou:_,decode:P,noConflict:function(){var e=r.Base64;return r.Base64=i,e},fromUint8Array:o,toUint8Array:v},"function"==typeof Object.defineProperty){var k=function(e){return{value:e,enumerable:!1,writable:!0,configurable:!0}};r.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",k((function(){return P(this)}))),Object.defineProperty(String.prototype,"toBase64",k((function(e){return y(this,e)}))),Object.defineProperty(String.prototype,"toBase64URI",k((function(){return y(this,!0)})))}}return r.Meteor&&(Base64=r.Base64),e.exports?e.exports.Base64=r.Base64:void 0===(n=function(){return r.Base64}.apply(t,[]))||(e.exports=n),{Base64:r.Base64}}(o)},129:(e,t)=>{"use strict";var r=Object.prototype.hasOwnProperty;function n(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(e){return null}}function o(e){try{return encodeURIComponent(e)}catch(e){return null}}t.stringify=function(e,t){t=t||"";var n,i,a=[];for(i in"string"!=typeof t&&(t="?"),e)if(r.call(e,i)){if((n=e[i])||null!=n&&!isNaN(n)||(n=""),i=o(i),n=o(n),null===i||null===n)continue;a.push(i+"="+n)}return a.length?t+a.join("&"):""},t.parse=function(e){for(var t,r=/([^=?#&]+)=?([^&]*)/g,o={};t=r.exec(e);){var i=n(t[1]),a=n(t[2]);null===i||null===a||i in o||(o[i]=a)}return o}},418:e=>{"use strict";e.exports=function(e,t){if(t=t.split(":")[0],!(e=+e))return!1;switch(t){case"http":case"ws":return 80!==e;case"https":case"wss":return 443!==e;case"ftp":return 21!==e;case"gopher":return 70!==e;case"file":return!1}return 0!==e}},564:(e,t,r)=>{"use strict";var n=r(418),o=r(129),i=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,a=/[\n\r\t]/g,s=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,l=/:\d+$/,u=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,c=/^[a-zA-Z]:/;function p(e){return(e||"").toString().replace(i,"")}var f=[["#","hash"],["?","query"],function(e,t){return m(t.protocol)?e.replace(/\\/g,"/"):e},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],d={hash:1,query:1};function h(e){var t,n=("undefined"!=typeof window?window:void 0!==r.g?r.g:"undefined"!=typeof self?self:{}).location||{},o={},i=typeof(e=e||n);if("blob:"===e.protocol)o=new v(unescape(e.pathname),{});else if("string"===i)for(t in o=new v(e,{}),d)delete o[t];else if("object"===i){for(t in e)t in d||(o[t]=e[t]);void 0===o.slashes&&(o.slashes=s.test(e.href))}return o}function m(e){return"file:"===e||"ftp:"===e||"http:"===e||"https:"===e||"ws:"===e||"wss:"===e}function y(e,t){e=(e=p(e)).replace(a,""),t=t||{};var r,n=u.exec(e),o=n[1]?n[1].toLowerCase():"",i=!!n[2],s=!!n[3],l=0;return i?s?(r=n[2]+n[3]+n[4],l=n[2].length+n[3].length):(r=n[2]+n[4],l=n[2].length):s?(r=n[3]+n[4],l=n[3].length):r=n[4],"file:"===o?l>=2&&(r=r.slice(2)):m(o)?r=n[4]:o?i&&(r=r.slice(2)):l>=2&&m(t.protocol)&&(r=n[4]),{protocol:o,slashes:i||m(o),slashesCount:l,rest:r}}function v(e,t,r){if(e=(e=p(e)).replace(a,""),!(this instanceof v))return new v(e,t,r);var i,s,l,u,d,g,b=f.slice(),_=typeof t,w=this,S=0;for("object"!==_&&"string"!==_&&(r=t,t=null),r&&"function"!=typeof r&&(r=o.parse),i=!(s=y(e||"",t=h(t))).protocol&&!s.slashes,w.slashes=s.slashes||i&&t.slashes,w.protocol=s.protocol||t.protocol||"",e=s.rest,("file:"===s.protocol&&(2!==s.slashesCount||c.test(e))||!s.slashes&&(s.protocol||s.slashesCount<2||!m(w.protocol)))&&(b[3]=[/(.*)/,"pathname"]);S<b.length;S++)"function"!=typeof(u=b[S])?(l=u[0],g=u[1],l!=l?w[g]=e:"string"==typeof l?~(d="@"===l?e.lastIndexOf(l):e.indexOf(l))&&("number"==typeof u[2]?(w[g]=e.slice(0,d),e=e.slice(d+u[2])):(w[g]=e.slice(d),e=e.slice(0,d))):(d=l.exec(e))&&(w[g]=d[1],e=e.slice(0,d.index)),w[g]=w[g]||i&&u[3]&&t[g]||"",u[4]&&(w[g]=w[g].toLowerCase())):e=u(e,w);r&&(w.query=r(w.query)),i&&t.slashes&&"/"!==w.pathname.charAt(0)&&(""!==w.pathname||""!==t.pathname)&&(w.pathname=function(e,t){if(""===e)return t;for(var r=(t||"/").split("/").slice(0,-1).concat(e.split("/")),n=r.length,o=r[n-1],i=!1,a=0;n--;)"."===r[n]?r.splice(n,1):".."===r[n]?(r.splice(n,1),a++):a&&(0===n&&(i=!0),r.splice(n,1),a--);return i&&r.unshift(""),"."!==o&&".."!==o||r.push(""),r.join("/")}(w.pathname,t.pathname)),"/"!==w.pathname.charAt(0)&&m(w.protocol)&&(w.pathname="/"+w.pathname),n(w.port,w.protocol)||(w.host=w.hostname,w.port=""),w.username=w.password="",w.auth&&(~(d=w.auth.indexOf(":"))?(w.username=w.auth.slice(0,d),w.username=encodeURIComponent(decodeURIComponent(w.username)),w.password=w.auth.slice(d+1),w.password=encodeURIComponent(decodeURIComponent(w.password))):w.username=encodeURIComponent(decodeURIComponent(w.auth)),w.auth=w.password?w.username+":"+w.password:w.username),w.origin="file:"!==w.protocol&&m(w.protocol)&&w.host?w.protocol+"//"+w.host:"null",w.href=w.toString()}v.prototype={set:function(e,t,r){var i=this;switch(e){case"query":"string"==typeof t&&t.length&&(t=(r||o.parse)(t)),i[e]=t;break;case"port":i[e]=t,n(t,i.protocol)?t&&(i.host=i.hostname+":"+t):(i.host=i.hostname,i[e]="");break;case"hostname":i[e]=t,i.port&&(t+=":"+i.port),i.host=t;break;case"host":i[e]=t,l.test(t)?(t=t.split(":"),i.port=t.pop(),i.hostname=t.join(":")):(i.hostname=t,i.port="");break;case"protocol":i.protocol=t.toLowerCase(),i.slashes=!r;break;case"pathname":case"hash":if(t){var a="pathname"===e?"/":"#";i[e]=t.charAt(0)!==a?a+t:t}else i[e]=t;break;case"username":case"password":i[e]=encodeURIComponent(t);break;case"auth":var s=t.indexOf(":");~s?(i.username=t.slice(0,s),i.username=encodeURIComponent(decodeURIComponent(i.username)),i.password=t.slice(s+1),i.password=encodeURIComponent(decodeURIComponent(i.password))):i.username=encodeURIComponent(decodeURIComponent(t))}for(var u=0;u<f.length;u++){var c=f[u];c[4]&&(i[c[1]]=i[c[1]].toLowerCase())}return i.auth=i.password?i.username+":"+i.password:i.username,i.origin="file:"!==i.protocol&&m(i.protocol)&&i.host?i.protocol+"//"+i.host:"null",i.href=i.toString(),i},toString:function(e){e&&"function"==typeof e||(e=o.stringify);var t,r=this,n=r.host,i=r.protocol;i&&":"!==i.charAt(i.length-1)&&(i+=":");var a=i+(r.protocol&&r.slashes||m(r.protocol)?"//":"");return r.username?(a+=r.username,r.password&&(a+=":"+r.password),a+="@"):r.password?(a+=":"+r.password,a+="@"):"file:"!==r.protocol&&m(r.protocol)&&!n&&"/"!==r.pathname&&(a+="@"),(":"===n[n.length-1]||l.test(r.hostname)&&!r.port)&&(n+=":"),a+=n+r.pathname,(t="object"==typeof r.query?e(r.query):r.query)&&(a+="?"!==t.charAt(0)?"?"+t:t),r.hash&&(a+=r.hash),a}},v.extractProtocol=y,v.location=h,v.trimLeft=p,v.qs=o,e.exports=v}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n].call(i.exports,i,i.exports,r),i.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";function e(){return e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},e.apply(this,arguments)}function t(t){var r=t.tracks;return(void 0===r?[]:r).map((function(t){return React.createElement("track",e({key:t.src},t))}))}var n=wp.blockEditor,o=n.RichText,i=n.useBlockProps;r(184);var a=r(575),s=r(564),l=r.n(s);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){return!t||"object"!==u(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){var t="function"==typeof Map?new Map:void 0;return f=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return d(e,arguments,y(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),m(n,e)},f(e)}function d(e,t,r){return d=h()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var o=new(Function.bind.apply(e,n));return r&&m(o,r.prototype),o},d.apply(null,arguments)}function h(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function m(e,t){return m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},m(e,t)}function y(e){return y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},y(e)}const v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(o,e);var t,r,n=(t=o,r=h(),function(){var e,n=y(t);if(r){var o=y(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return p(this,e)});function o(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(c(this,o),(t=n.call(this,e)).originalRequest=i,t.originalResponse=a,t.causingError=r,null!=r&&(e+=", caused by ".concat(r.toString())),null!=i){var s=i.getHeader("X-Request-ID")||"n/a",l=i.getMethod(),u=i.getURL(),p=a?a.getStatus():"n/a",f=a?a.getBody()||"":"n/a";e+=", originated from request (method: ".concat(l,", url: ").concat(u,", response code: ").concat(p,", response text: ").concat(f,", request id: ").concat(s,")")}return t.message=e,t}return o}(f(Error));function g(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?g(Object(r),!0).forEach((function(t){w(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function w(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function S(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var E=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),"resume"in r&&console.log("tus: The `resume` option has been removed in tus-js-client v2. Please use the URL storage API instead."),this.options=r,this.options.chunkSize=+this.options.chunkSize,this._urlStorage=this.options.urlStorage,this.file=t,this.url=null,this._req=null,this._fingerprint=null,this._urlStorageKey=null,this._offset=null,this._aborted=!1,this._size=null,this._source=null,this._retryAttempt=0,this._retryTimeout=null,this._offsetBeforeRetry=0,this._parallelUploads=null,this._parallelUploadUrls=null}var t,r,n;return t=e,r=[{key:"findPreviousUploads",value:function(){var e=this;return this.options.fingerprint(this.file,this.options).then((function(t){return e._urlStorage.findUploadsByFingerprint(t)}))}},{key:"resumeFromPreviousUpload",value:function(e){this.url=e.uploadUrl||null,this._parallelUploadUrls=e.parallelUploadUrls||null,this._urlStorageKey=e.urlStorageKey}},{key:"start",value:function(){var e=this,t=this.file;if(t)if(this.options.endpoint||this.options.uploadUrl){var r=this.options.retryDelays;null==r||"[object Array]"===Object.prototype.toString.call(r)?(this.options.parallelUploads>1&&["uploadUrl","uploadSize","uploadLengthDeferred"].forEach((function(t){e.options[t]&&e._emitError(new Error("tus: cannot use the ".concat(t," option when parallelUploads is enabled")))})),this.options.fingerprint(t,this.options).then((function(r){return null==r||"Calculated fingerprint: ".concat(r),e._fingerprint=r,e._source?e._source:e.options.fileReader.openFile(t,e.options.chunkSize)})).then((function(t){e._source=t,e.options.parallelUploads>1||null!=e._parallelUploadUrls?e._startParallelUpload():e._startSingleUpload()})).catch((function(t){e._emitError(t)}))):this._emitError(new Error("tus: the `retryDelays` option must either be an array or null"))}else this._emitError(new Error("tus: neither an endpoint or an upload URL is provided"));else this._emitError(new Error("tus: no file or stream to upload provided"))}},{key:"_startParallelUpload",value:function(){var t=this,r=this._size=this._source.size,n=0;this._parallelUploads=[];var o=null!=this._parallelUploadUrls?this._parallelUploadUrls.length:this.options.parallelUploads,i=function(e,t,r){for(var n=Math.floor(e/t),o=[],i=0;i<t;i++)o.push({start:n*i,end:n*(i+1)});return o[t-1].end=e,r&&o.forEach((function(e,t){e.uploadUrl=r[t]||null})),o}(this._source.size,o,this._parallelUploadUrls);this._parallelUploadUrls=new Array(i.length);var a,s=i.map((function(o,a){var s=0;return t._source.slice(o.start,o.end).then((function(l){var u=l.value;return new Promise((function(l,c){var p=b(b({},t.options),{},{uploadUrl:o.uploadUrl||null,storeFingerprintForResuming:!1,removeFingerprintOnSuccess:!1,parallelUploads:1,metadata:{},headers:b(b({},t.options.headers),{},{"Upload-Concat":"partial"}),onSuccess:l,onError:c,onProgress:function(e){n=n-s+e,s=e,t._emitProgress(n,r)},_onUploadUrlAvailable:function(){t._parallelUploadUrls[a]=f.url,t._parallelUploadUrls.filter((function(e){return!!e})).length===i.length&&t._saveUploadInUrlStorage()}}),f=new e(u,p);f.start(),t._parallelUploads.push(f)}))}))}));Promise.all(s).then((function(){(a=t._openRequest("POST",t.options.endpoint)).setHeader("Upload-Concat","final;".concat(t._parallelUploadUrls.join(" ")));var e=U(t.options.metadata);return""!==e&&a.setHeader("Upload-Metadata",e),t._sendRequest(a,null)})).then((function(e){if(P(e.getStatus(),200)){var r=e.getHeader("Location");null!=r?(t.url=j(t.options.endpoint,r),"Created upload at ".concat(t.url),t._emitSuccess()):t._emitHttpError(a,e,"tus: invalid or missing Location header")}else t._emitHttpError(a,e,"tus: unexpected response while creating upload")})).catch((function(e){t._emitError(e)}))}},{key:"_startSingleUpload",value:function(){if(this.options.uploadLengthDeferred)this._size=null;else if(null!=this.options.uploadSize){if(this._size=+this.options.uploadSize,isNaN(this._size))return void this._emitError(new Error("tus: cannot convert `uploadSize` option into a number"))}else if(this._size=this._source.size,null==this._size)return void this._emitError(new Error("tus: cannot automatically derive upload's size from input. Specify it manually using the `uploadSize` option or use the `uploadLengthDeferred` option"));return this._aborted=!1,null!=this.url?("Resuming upload from previous URL: ".concat(this.url),void this._resumeUpload()):null!=this.options.uploadUrl?("Resuming upload from provided URL: ".concat(this.options.uploadUrl),this.url=this.options.uploadUrl,void this._resumeUpload()):void this._createUpload()}},{key:"abort",value:function(t){var r=this;if(arguments.length>1&&"function"==typeof arguments[1])throw new Error("tus: the abort function does not accept a callback since v2 anymore; please use the returned Promise instead");return null!=this._parallelUploads&&this._parallelUploads.forEach((function(e){e.abort(t)})),null!==this._req&&(this._req.abort(),this._source.close()),this._aborted=!0,null!=this._retryTimeout&&(clearTimeout(this._retryTimeout),this._retryTimeout=null),t&&null!=this.url?e.terminate(this.url,this.options).then((function(){return r._removeFromUrlStorage()})):Promise.resolve()}},{key:"_emitHttpError",value:function(e,t,r,n){this._emitError(new v(r,n,e,t))}},{key:"_emitError",value:function(e){var t=this;if(!this._aborted){if(null!=this.options.retryDelays&&(null!=this._offset&&this._offset>this._offsetBeforeRetry&&(this._retryAttempt=0),O(e,this._retryAttempt,this.options))){var r=this.options.retryDelays[this._retryAttempt++];return this._offsetBeforeRetry=this._offset,void(this._retryTimeout=setTimeout((function(){t.start()}),r))}if("function"!=typeof this.options.onError)throw e;this.options.onError(e)}}},{key:"_emitSuccess",value:function(){this.options.removeFingerprintOnSuccess&&this._removeFromUrlStorage(),"function"==typeof this.options.onSuccess&&this.options.onSuccess()}},{key:"_emitProgress",value:function(e,t){"function"==typeof this.options.onProgress&&this.options.onProgress(e,t)}},{key:"_emitChunkComplete",value:function(e,t,r){"function"==typeof this.options.onChunkComplete&&this.options.onChunkComplete(e,t,r)}},{key:"_createUpload",value:function(){var e=this;if(this.options.endpoint){var t=this._openRequest("POST",this.options.endpoint);this.options.uploadLengthDeferred?t.setHeader("Upload-Defer-Length",1):t.setHeader("Upload-Length",this._size);var r,n=U(this.options.metadata);""!==n&&t.setHeader("Upload-Metadata",n),this.options.uploadDataDuringCreation&&!this.options.uploadLengthDeferred?(this._offset=0,r=this._addChunkToRequest(t)):r=this._sendRequest(t,null),r.then((function(r){if(P(r.getStatus(),200)){var n=r.getHeader("Location");if(null!=n){if(e.url=j(e.options.endpoint,n),"Created upload at ".concat(e.url),"function"==typeof e.options._onUploadUrlAvailable&&e.options._onUploadUrlAvailable(),0===e._size)return e._emitSuccess(),void e._source.close();e._saveUploadInUrlStorage(),e.options.uploadDataDuringCreation?e._handleUploadResponse(t,r):(e._offset=0,e._performUpload())}else e._emitHttpError(t,r,"tus: invalid or missing Location header")}else e._emitHttpError(t,r,"tus: unexpected response while creating upload")})).catch((function(r){e._emitHttpError(t,null,"tus: failed to create upload",r)}))}else this._emitError(new Error("tus: unable to create upload because no endpoint is provided"))}},{key:"_resumeUpload",value:function(){var e=this,t=this._openRequest("HEAD",this.url);this._sendRequest(t,null).then((function(r){var n=r.getStatus();if(!P(n,200))return P(n,400)&&e._removeFromUrlStorage(),423===n?void e._emitHttpError(t,r,"tus: upload is currently locked; retry later"):e.options.endpoint?(e.url=null,void e._createUpload()):void e._emitHttpError(t,r,"tus: unable to resume upload (new upload cannot be created without an endpoint)");var o=parseInt(r.getHeader("Upload-Offset"),10);if(isNaN(o))e._emitHttpError(t,r,"tus: invalid or missing offset value");else{var i=parseInt(r.getHeader("Upload-Length"),10);if(!isNaN(i)||e.options.uploadLengthDeferred){if("function"==typeof e.options._onUploadUrlAvailable&&e.options._onUploadUrlAvailable(),o===i)return e._emitProgress(i,i),void e._emitSuccess();e._offset=o,e._performUpload()}else e._emitHttpError(t,r,"tus: invalid or missing length value")}})).catch((function(r){e._emitHttpError(t,null,"tus: failed to resume upload",r)}))}},{key:"_performUpload",value:function(){var e,t=this;this._aborted||(this.options.overridePatchMethod?(e=this._openRequest("POST",this.url)).setHeader("X-HTTP-Method-Override","PATCH"):e=this._openRequest("PATCH",this.url),e.setHeader("Upload-Offset",this._offset),this._addChunkToRequest(e).then((function(r){P(r.getStatus(),200)?t._handleUploadResponse(e,r):t._emitHttpError(e,r,"tus: unexpected response while uploading chunk")})).catch((function(r){t._aborted||t._emitHttpError(e,null,"tus: failed to upload chunk at offset ".concat(t._offset),r)})))}},{key:"_addChunkToRequest",value:function(e){var t=this,r=this._offset,n=this._offset+this.options.chunkSize;return e.setProgressHandler((function(e){t._emitProgress(r+e,t._size)})),e.setHeader("Content-Type","application/offset+octet-stream"),(n===1/0||n>this._size)&&!this.options.uploadLengthDeferred&&(n=this._size),this._source.slice(r,n).then((function(r){var n=r.value,o=r.done;return t.options.uploadLengthDeferred&&o&&(t._size=t._offset+(n&&n.size?n.size:0),e.setHeader("Upload-Length",t._size)),null===n?t._sendRequest(e):(t._emitProgress(t._offset,t._size),t._sendRequest(e,n))}))}},{key:"_handleUploadResponse",value:function(e,t){var r=parseInt(t.getHeader("Upload-Offset"),10);if(isNaN(r))this._emitHttpError(e,t,"tus: invalid or missing offset value");else{if(this._emitProgress(r,this._size),this._emitChunkComplete(r-this._offset,r,this._size),this._offset=r,r==this._size)return this._emitSuccess(),void this._source.close();this._performUpload()}}},{key:"_openRequest",value:function(e,t){var r=k(e,t,this.options);return this._req=r,r}},{key:"_removeFromUrlStorage",value:function(){var e=this;this._urlStorageKey&&(this._urlStorage.removeUpload(this._urlStorageKey).catch((function(t){e._emitError(t)})),this._urlStorageKey=null)}},{key:"_saveUploadInUrlStorage",value:function(){var e=this;if(this.options.storeFingerprintForResuming&&this._fingerprint){var t={size:this._size,metadata:this.options.metadata,creationTime:(new Date).toString()};this._parallelUploads?t.parallelUploadUrls=this._parallelUploadUrls:t.uploadUrl=this.url,this._urlStorage.addUpload(this._fingerprint,t).then((function(t){return e._urlStorageKey=t})).catch((function(t){e._emitError(t)}))}}},{key:"_sendRequest",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return R(e,t,this.options)}}],n=[{key:"terminate",value:function(t,r){if(arguments.length>1&&"function"==typeof arguments[arguments.length-1])throw new Error("tus: the terminate function does not accept a callback since v2 anymore; please use the returned Promise instead");void 0===r&&(r={});var n=k("DELETE",t,r);return R(n,null,r).then((function(e){if(204!==e.getStatus())throw new v("tus: unexpected response while terminating upload",null,n,e)})).catch((function(o){if(o instanceof v||(o=new v("tus: failed to terminate upload",o,n,null)),!O(o,0,r))throw o;var i=r.retryDelays[0],a=r.retryDelays.slice(1),s=b(b({},r),{},{retryDelays:a});return new Promise((function(e){return setTimeout(e,i)})).then((function(){return e.terminate(t,s)}))}))}}],r&&S(t.prototype,r),n&&S(t,n),e}();function U(e){var t=[];for(var r in e)t.push("".concat(r," ").concat(a.Base64.encode(e[r])));return t.join(",")}function P(e,t){return e>=t&&e<t+100}function k(e,t,r){var n=r.httpStack.createRequest(e,t);n.setHeader("Tus-Resumable","1.0.0");var o=r.headers||{};for(var i in o)n.setHeader(i,o[i]);if(r.addRequestId){var a="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}));n.setHeader("X-Request-ID",a)}return n}function R(e,t,r){return("function"==typeof r.onBeforeRequest?Promise.resolve(r.onBeforeRequest(e)):Promise.resolve()).then((function(){return e.send(t).then((function(t){return("function"==typeof r.onAfterResponse?Promise.resolve(r.onAfterResponse(e,t)):Promise.resolve()).then((function(){return t}))}))}))}function O(e,t,r){if(null==r.retryDelays||t>=r.retryDelays.length||null==e.originalRequest)return!1;if(r&&"function"==typeof r.onShouldRetry)return r.onShouldRetry(e,t,r);var n,o=e.originalResponse?e.originalResponse.getStatus():0;return(!P(o,400)||409===o||423===o)&&(n=!0,"undefined"!=typeof window&&"navigator"in window&&!1===window.navigator.onLine&&(n=!1),n)}function j(e,t){return new(l())(t,e).toString()}E.defaultOptions={endpoint:null,uploadUrl:null,metadata:{},fingerprint:null,uploadSize:null,onProgress:null,onChunkComplete:null,onSuccess:null,onError:null,_onUploadUrlAvailable:null,overridePatchMethod:!1,headers:{},addRequestId:!1,onBeforeRequest:null,onAfterResponse:null,onShouldRetry:null,chunkSize:1/0,retryDelays:[0,1e3,3e3,5e3],parallelUploads:1,storeFingerprintForResuming:!0,removeFingerprintOnSuccess:!1,uploadLengthDeferred:!1,uploadDataDuringCreation:!1,urlStorage:null,fileReader:null,httpStack:null};const x=E;function C(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var A=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r;return t=e,(r=[{key:"listAllUploads",value:function(){return Promise.resolve([])}},{key:"findUploadsByFingerprint",value:function(e){return Promise.resolve([])}},{key:"removeUpload",value:function(e){return Promise.resolve()}},{key:"addUpload",value:function(e,t){return Promise.resolve(null)}}])&&C(t.prototype,r),e}();function T(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var D=!1;try{D="localStorage"in window;var F="tusSupport";localStorage.setItem(F,localStorage.getItem(F))}catch(e){if(e.code!==e.SECURITY_ERR&&e.code!==e.QUOTA_EXCEEDED_ERR)throw e;D=!1}var B=D,I=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r;return t=e,r=[{key:"findAllUploads",value:function(){var e=this._findEntries("tus::");return Promise.resolve(e)}},{key:"findUploadsByFingerprint",value:function(e){var t=this._findEntries("tus::".concat(e,"::"));return Promise.resolve(t)}},{key:"removeUpload",value:function(e){return localStorage.removeItem(e),Promise.resolve()}},{key:"addUpload",value:function(e,t){var r=Math.round(1e12*Math.random()),n="tus::".concat(e,"::").concat(r);return localStorage.setItem(n,JSON.stringify(t)),Promise.resolve(n)}},{key:"_findEntries",value:function(e){for(var t=[],r=0;r<localStorage.length;r++){var n=localStorage.key(r);if(0===n.indexOf(e))try{var o=JSON.parse(localStorage.getItem(n));o.urlStorageKey=n,t.push(o)}catch(e){}}return t}}],r&&T(t.prototype,r),e}();function z(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function q(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function L(e,t,r){return t&&q(e.prototype,t),r&&q(e,r),e}var H=function(){function e(){z(this,e)}return L(e,[{key:"createRequest",value:function(e,t){return new N(e,t)}},{key:"getName",value:function(){return"XHRHttpStack"}}]),e}(),N=function(){function e(t,r){z(this,e),this._xhr=new XMLHttpRequest,this._xhr.open(t,r,!0),this._method=t,this._url=r,this._headers={}}return L(e,[{key:"getMethod",value:function(){return this._method}},{key:"getURL",value:function(){return this._url}},{key:"setHeader",value:function(e,t){this._xhr.setRequestHeader(e,t),this._headers[e]=t}},{key:"getHeader",value:function(e){return this._headers[e]}},{key:"setProgressHandler",value:function(e){"upload"in this._xhr&&(this._xhr.upload.onprogress=function(t){t.lengthComputable&&e(t.loaded)})}},{key:"send",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return new Promise((function(r,n){e._xhr.onload=function(){r(new Q(e._xhr))},e._xhr.onerror=function(e){n(e)},e._xhr.send(t)}))}},{key:"abort",value:function(){return this._xhr.abort(),Promise.resolve()}},{key:"getUnderlyingObject",value:function(){return this._xhr}}]),e}(),Q=function(){function e(t){z(this,e),this._xhr=t}return L(e,[{key:"getStatus",value:function(){return this._xhr.status}},{key:"getHeader",value:function(e){return this._xhr.getResponseHeader(e)}},{key:"getBody",value:function(){return this._xhr.responseText}},{key:"getUnderlyingObject",value:function(){return this._xhr}}]),e}();const M=function(){return"undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase()};function X(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var K=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._file=t,this.size=t.size}var t,r;return t=e,(r=[{key:"slice",value:function(e,t){if("undefined"!=typeof window&&(void 0!==window.PhoneGap||void 0!==window.Cordova||void 0!==window.cordova))return r=this._file.slice(e,t),new Promise((function(e,t){var n=new FileReader;n.onload=function(){var t=new Uint8Array(n.result);e({value:t})},n.onerror=function(e){t(e)},n.readAsArrayBuffer(r)}));var r,n=this._file.slice(e,t);return Promise.resolve({value:n})}},{key:"close",value:function(){}}])&&X(t.prototype,r),e}();function J(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function W(e){return void 0===e?0:void 0!==e.size?e.size:e.length}var Z=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._chunkSize=r,this._buffer=void 0,this._bufferOffset=0,this._reader=t,this._done=!1}var t,r;return t=e,(r=[{key:"slice",value:function(e,t){return e<this._bufferOffset?Promise.reject(new Error("Requested data is before the reader's current offset")):this._readUntilEnoughDataOrDone(e,t)}},{key:"_readUntilEnoughDataOrDone",value:function(e,t){var r=this,n=t<=this._bufferOffset+W(this._buffer);if(this._done||n){var o=this._getDataFromBuffer(e,t),i=null==o&&this._done;return Promise.resolve({value:o,done:i})}return this._reader.read().then((function(n){var o=n.value;return n.done?r._done=!0:void 0===r._buffer?r._buffer=o:r._buffer=function(e,t){if(e.concat)return e.concat(t);if(e instanceof Blob)return new Blob([e,t],{type:e.type});if(e.set){var r=new e.constructor(e.length+t.length);return r.set(e),r.set(t,e.length),r}throw new Error("Unknown data type")}(r._buffer,o),r._readUntilEnoughDataOrDone(e,t)}))}},{key:"_getDataFromBuffer",value:function(e,t){e>this._bufferOffset&&(this._buffer=this._buffer.slice(e-this._bufferOffset),this._bufferOffset=e);var r=0===W(this._buffer);return this._done&&r?null:this._buffer.slice(0,t-e)}},{key:"close",value:function(){this._reader.cancel&&this._reader.cancel()}}])&&J(t.prototype,r),e}();function G(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var V=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r;return t=e,(r=[{key:"openFile",value:function(e,t){return M()&&e&&void 0!==e.uri?(r=e.uri,new Promise((function(e,t){var n=new XMLHttpRequest;n.responseType="blob",n.onload=function(){var t=n.response;e(t)},n.onerror=function(e){t(e)},n.open("GET",r),n.send()}))).then((function(e){return new K(e)})).catch((function(e){throw new Error("tus: cannot fetch `file.uri` as Blob, make sure the uri is correct and accessible. ".concat(e))})):"function"==typeof e.slice&&void 0!==e.size?Promise.resolve(new K(e)):"function"==typeof e.read?(t=+t,isFinite(t)?Promise.resolve(new Z(e,t)):Promise.reject(new Error("cannot create source for stream without a finite value for the `chunkSize` option"))):Promise.reject(new Error("source object may only be an instance of File, Blob, or Reader in this environment"));var r}}])&&G(t.prototype,r),e}();function Y(e){return Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Y(e)}function $(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function te(e,t){return te=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},te(e,t)}function re(e,t){return!t||"object"!==Y(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ne(e){return ne=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ne(e)}function oe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ie(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(r),!0).forEach((function(t){ae(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ae(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var se=ie(ie({},x.defaultOptions),{},{httpStack:new H,fileReader:new V,urlStorage:B?new I:new A,fingerprint:function(e,t){return M()?Promise.resolve(function(e,t){var r=e.exif?function(e){var t=0;if(0===e.length)return t;for(var r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r),t&=t;return t}(JSON.stringify(e.exif)):"noexif";return["tus-rn",e.name||"noname",e.size||"nosize",r,t.endpoint].join("/")}(e,t)):Promise.resolve(["tus-br",e.name,e.type,e.size,e.lastModified,t.endpoint].join("-"))}}),le=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&te(e,t)}(a,e);var t,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ne(n);if(o){var r=ne(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return re(this,e)});function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return $(this,a),t=ie(ie({},se),t),i.call(this,e,t)}return t=a,r=[{key:"terminate",value:function(e,t,r){return t=ie(ie({},se),t),x.terminate(e,t,r)}}],null&&ee(t.prototype,null),r&&ee(t,r),a}(x),ue=window,ce=ue.XMLHttpRequest,pe=ue.Blob;ce&&pe&&pe.prototype.slice;var fe=wp.i18n,de=fe.__,he=fe._x,me=wp.components,ye=(me.ToggleControl,me.SelectControl,wp.element);ye.useMemo,ye.useCallback,ye.Platform,de("Auto"),de("Metadata"),he("None","Preload value");var ve=wp.i18n,ge=ve.__,be=(ve.sprintf,wp.components),_e=(be.NavigableMenu,be.MenuItem,be.FormFileUpload,be.MenuGroup,be.ToolbarButton,be.Dropdown,be.SVG,be.Rect,be.Path,be.Button,be.TextControl,be.SelectControl,wp.blockEditor);_e.MediaUpload,_e.MediaUploadCheck,_e.store,wp.data.useSelect,wp.element.useState,wp.url.getFilename,ge("Subtitles"),ge("Captions"),ge("Descriptions"),ge("Chapters"),ge("Metadata");var we=wp.media.view.MediaFrame.Post,Se=wp.media.controller.Library,Ee=wp.media.view.l10n;function Ue(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Pe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ke(e,t,r){return t&&Pe(e.prototype,t),r&&Pe(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}const Re=new(ke((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var t=js_sv_cloudflare_stream_block_stream_scripts_sv_cloudflare_stream_editor_script;this.nonce=t.nonce,this.api=t.api,this.media=t.media,this.media.model.Query=function(e){return wp.media.model.Query.extend({initialize:function(t,r){r=r||{},wp.media.model.Query.prototype.initialize.apply(this,arguments),this.args=r.args||{},this.args.posts_per_page=e.api.posts_per_page},sync:function(t,r,n){if("read"===t){(n=n||{}).context=this,n.data=_.extend(n.data||{},{action:"sv-query-cloudflare-stream-attachments",post_id:wp.media.model.settings.post.id,nonce:e.nonce});var o="";e.media.model.Attachments.all.models.length>0&&(o="&end="+e.media.model.Attachments.all.models[e.media.model.Attachments.all.models.length-1].attributes.modified.toISOString());var i=_.clone(this.args);return-1!==i.posts_per_page&&(i.paged=Math.floor(this.length/i.posts_per_page)+1),n.data.query="asc=false"+o,wp.media.ajax(n)}return(wp.media.model.Attachments.prototype.sync?wp.media.model.Attachments.prototype:Backbone).sync.apply(this,arguments)}},{get:(t=[],function(r,n){var o,i={},a=e.media.model.Query.orderby,s=e.media.model.Query.defaultProps;return delete r.query,delete r.remotefilters,delete r.uioptions,_.defaults(r,s),r.order=r.order.toUpperCase(),"DESC"!==r.order&&"ASC"!==r.order&&(r.order=s.order.toUpperCase()),_.contains(a.allowed,r.orderby)||(r.orderby=s.orderby),_.each(r,(function(t,r){_.isNull(t)||(i[e.media.model.Query.propmap[r]||r]=t)})),_.defaults(i,e.media.model.Query.defaultArgs),i.orderby=a.valuemap[r.orderby]||r.orderby,(o=_.find(t,(function(e){return _.isEqual(e.args,i)})))||(o=new e.media.model.Query([],_.extend(n||{},{props:r,args:i})),t.push(o)),o})});var t}(this),this.media.model.Attachments=function(e){return wp.media.model.Attachments.extend({initialize:function(){wp.media.model.Attachments.prototype.initialize.apply(this,arguments)},_requery:function(t){this.props.get("query")&&(this.props.toJSON().cache=!0!==t,this.mirror(e.media.model.Query.get(this.props.toJSON())))}})}(this),this.media.view.MediaFrame=function(e){return we.extend({initialize:function(e){this.select=e,_.defaults(this.options,{id:"cloudflare-stream",className:"cloudflare-stream-media-frame",title:"Cloudflare Stream Library",multiple:!1,editing:!1,state:"insert",metadata:{}}),we.prototype.initialize.apply(this,arguments)},createStates:function(){var t=this.options;this.states.add([new Se({id:"insert",title:t.title,priority:20,toolbar:"main-insert",menu:!1,filterable:!1,searchable:!1,date:!1,library:new e.media.model.Query(null,_.defaults({type:"video"},t.library)),multiple:!!t.multiple&&"reset",editable:!0,allowLocalEdits:!0,displaySettings:!1,displayUserSettings:!1})])},bindHandlers:function(){var e;we.prototype.bindHandlers.apply(this,arguments),this.on("activate",this.activate,this),void 0!==_.find(this.counts,(function(e){return 0===e.count}))&&this.listenTo(wp.media.model.Attachments.all,"change:type",this.mediaTypeCounts),this.on("toolbar:create:main-insert",this.createToolbar,this),this.on("selection:toggle",this.bindSidebarItems,this),e={toolbar:{"main-insert":"mainInsertToolbar"}},_.each(e,(function(e,t){_.each(e,(function(e,r){this.on(t+":render:"+r,this[e],this)}),this)}),this)},bindSidebarItems:function(){jQuery(".delete-attachment").on("click",this,this.deleteAttachment),jQuery('label[data-setting="title"] input').on("change",this,this.updateAttachment)},deleteAttachment:function(e){e.preventDefault(),e.stopPropagation();var t=e.data;if(window.confirm(Ee.warnDelete)){var r=t.state(),n=r.get("selection"),o=n.first().toJSON();n.remove(o),r.trigger("delete",o).reset()}},updateAttachment:function(t){t.preventDefault(),t.stopPropagation();var r=t.data.state().get("selection"),n=r.first().toJSON(),o=jQuery('label[data-setting="title"] input').val(),i={uid:n.uid,meta:{name:o,upload:n.cloudflare.meta.upload}};jQuery(".media-sidebar .spinner").css("visibility","visible"),jQuery.ajax({url:"https://api.cloudflare.com/client/v4/accounts/"+e.api.account+"/media/"+n.uid,method:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(i),headers:{"X-Auth-Email":e.api.email,"X-Auth-Key":e.api.key},success:function(){r.models[0].set("filename",o),jQuery(".media-sidebar .spinner").css("visibility","hidden")},error:function(e,t){console.error("Error: "+t)}})},browseRouter:function(e){e.set({browse:{text:this.options.title,priority:40}})},mainInsertToolbar:function(e){var t=this;e.set("insert",{style:"primary",priority:80,text:"Select",requires:{selection:!0},click:function(){var e=t.state(),r=e.get("selection"),n=r.first().toJSON();console.log(t),t.select(n),t.close(),e.trigger("insert",r).reset()}})}})}(this),this.analytics=function(e){return new(function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),jQuery("#submit").on("click",(function(){e.analytics.logEvent("Stream WP Plugin - Settings Saved")}))}var r,n;return r=t,(n=[{key:"logEvent",value:function(e){}}])&&Ue(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),t}())}(this)})));function Oe(e){return Oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Oe(e)}function je(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ce(e,t){return Ce=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Ce(e,t)}function Ae(e,t){if(t&&("object"===Oe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Te(e)}function Te(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function De(e){return De=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},De(e)}var Fe=wp.blob,Be=(Fe.getBlobByURL,Fe.isBlobURL,wp.components),Ie=(Be.BaseControl,Be.Button),ze=Be.Disabled,qe=Be.PanelBody,Le=(Be.Spinner,Be.withNotices),He=Be.Placeholder,Ne=Be.FormFileUpload,Qe=Be.Toolbar,Me=Be.ToggleControl,Xe=wp.blockEditor,Ke=Xe.BlockControls,Je=(Xe.BlockIcon,Xe.InspectorControls),We=(Xe.MediaPlaceholder,Xe.MediaUpload),Ze=(Xe.MediaUploadCheck,Xe.MediaReplaceFlow,Xe.RichText,Xe.useBlockProps,Xe.store,wp.element),Ge=(Ze.useRef,Ze.Fragment),Ve=Ze.Component,Ye=Ze.createRef,$e=(Ze.useEffect,wp.i18n),et=$e.__,tt=($e.sprintf,wp.compose.useInstanceId,wp.data.useSelect,function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ce(e,t)}(a,e);var t,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=De(n);if(o){var r=De(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return Ae(this,e)});function a(e){var t;return je(this,a),(t=i.apply(this,arguments)).state={editing:!t.props.attributes.uid,uploading:!1,encoding:t.props.attributes.uid&&!t.props.attributes.thumbnail,resume:!0},t.instanceId=e.clientId,t.controller=Te(t),t.streamPlayer=Ye(),t.toggleAttribute=t.toggleAttribute.bind(Te(t)),t.open=t.open.bind(Te(t)),t.select=t.select.bind(Te(t)),t.mediaFrame=new Re.media.view.MediaFrame(t.select),t.encodingPoller=!1,t}return t=a,r=[{key:"componentDidMount",value:function(){var e=this.props.attributes;!1!==e.uid&&!1===e.thumbnail?this.switchToEncoding():this.reload()}},{key:"componentDidUpdate",value:function(){var e=this.props.attributes,t=this.streamPlayer.current;null!==t&&null!==t.play&&(t.autoPlay=e.autoplay,t.controls=e.controls,t.mute=e.mute,t.loop=e.loop,t.controls=e.controls,e.autoplay&&"function"==typeof t.play?t.play():"function"==typeof t.pause&&t.pause()),!1!==e.uid&&(jQuery("#block-"+this.instanceId+" .editor-media-placeholder__cancel-button").show(),this.reload())}},{key:"toggleAttribute",value:function(e){var t=this.props.setAttributes;return function(r){t(function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}({},e,r))}}},{key:"open",value:function(){var e=this;this.mediaFrame.open(),this.mediaFrame.on("delete",(function(t){e.delete(t)})),this.mediaFrame.on("select",(function(){e.select()}))}},{key:"select",value:function(e){(0,this.props.setAttributes)({uid:e.uid,thumbnail:e.thumb.src}),this.setState({editing:!1,uploading:!1,encoding:!1}),Re.analytics.logEvent("Stream WP Plugin - Added to blog post"),this.reload()}},{key:"delete",value:function(e){jQuery.ajax({url:ajaxurl+"?action=cloudflare-stream-delete",data:{nonce:Re.nonce,uid:e.uid},success:function(){jQuery('li[data-id="'+e.id+'"]').hide()},error:function(e,t){console.error("Error: "+t),Re.analytics.logEvent("Stream WP Plugin - Error")}})}},{key:"update",value:function(e){jQuery(".settings-save-status .media-frame .spinner").css("visibility","visible"),jQuery.ajax({url:ajaxurl+"?action=cloudflare-stream-update",method:"POST",data:{nonce:Re.nonce,uid:e.uid,title:e.title},success:function(){jQuery('li[data-id="'+e.id+'"]').hide()},error:function(e,t){console.error("Error: "+t),Re.analytics.logEvent("Stream WP Plugin - Error")}})}},{key:"reload",value:function(){var e="https://embed.videodelivery.net/embed/r4xu.fla9.latest.js?video="+this.props.attributes.uid;jQuery.getScript(e).fail((function(e,t,r){console.error("Exception:"+r)}))}},{key:"uploadFromFiles",value:function(e){var t=this,r=this.props.setAttributes,n=jQuery("#progressbar-"+this.instanceId),o=jQuery(".progress-label-"+this.instanceId),i=n.progressbar("value")||0;n.progressbar("value",i);var a="https://api.cloudflare.com/client/v4/accounts/"+Re.api.account+"/media";Re.analytics.logEvent("Stream WP Plugin - Started uploading a video");var s=new le(e,{resume:t.state.resume,removeFingerprintOnSuccess:!0,endpoint:a,retryDelays:[0,1e3,3e3,5e3],headers:{"X-Auth-Email":Re.api.email,"X-Auth-Key":Re.api.key},metadata:{name:e.name,type:e.type},onError:function(e){console.error("Error: "+e),n.hide(),jQuery(".editor-media-placeholder .components-placeholder__instructions").html("Upload Error: See the console for details."),jQuery(".editor-media-placeholder__retry-button").show(),Re.analytics.logEvent("Stream WP Plugin - Error")},onProgress:function(e,t){var r=parseInt(e/t*100);o.text(r+"%"),n.progressbar("option","value",r)},onSuccess:function(){var e=s.url.split("/"),n=e[e.length-1];r({uid:n,fingerprint:s.options.fingerprint(s.file,s.options)}),Re.analytics.logEvent("Stream WP Plugin - Finished uploading a video"),t.switchToEncoding()}});s.start()}},{key:"switchToEncoding",value:function(){var e=this,t=this;t.setState({editing:!0,uploading:!1,encoding:!0},(function(){var r=jQuery("#progressbar-"+e.instanceId),n=jQuery(".progress-label-"+e.instanceId);jQuery(".editor-media-placeholder .components-placeholder__instructions").html("Upload Complete. Processing video."),n.text(""),r.progressbar({value:!1}),t.encode()}))}},{key:"encode",value:function(){var e=this.props,t=e.attributes,r=e.setAttributes,n=this,o=jQuery("#progressbar-"+this.instanceId),i=jQuery(".progress-label-"+this.instanceId),a=this.props.attributes.file;jQuery.ajax({url:ajaxurl+"?action=cloudflare-stream-check-upload",data:{nonce:Re.nonce,uid:t.uid},success:function(e){if(e.success){if(void 0!==e.data){if(!0===e.data.readyToStream&&void 0!==e.data.thumbnail?(clearTimeout(n.encodingPoller),r({thumbnail:e.data.thumbnail}),n.setState({editing:!1,uploading:!1,encoding:!1})):n.encodingPoller=setTimeout((function(){n.encode()}),5e3),"queued"===e.data.status.state)i.text(""),o.progressbar({value:!1});else if("inprogress"===e.data.status.state){var t=Math.round(e.data.status.pctComplete);i.text(t+"%"),o.progressbar({value:t})}n.reload()}}else console.error("Error: "+e.data),!0===n.state.resume?(n.setState({resume:!1}),jQuery(".editor-media-placeholder .components-placeholder__instructions").html("Uploading your video."),n.uploadFromFiles(a)):(o.hide(),jQuery(".editor-media-placeholder .components-placeholder__instructions").html("Processing Error: "+e.data),jQuery(".editor-media-placeholder__retry-button").show())},error:function(e,t){console.error("Error: "+t)}})}},{key:"render",value:function(){var e=this,t=this.props.attributes,r=t.uid,n=t.autoplay,o=t.controls,i=t.loop,a=t.muted,s=this.props,l=s.className,u=s.isSelected,c=this.state,p=c.editing,f=c.uploading,d=c.encoding,h=function(){e.setState({editing:!0}),e.setState({uploading:!1}),e.setState({encoding:!1})},m=function(){e.setState({editing:!1}),e.setState({uploading:!1}),e.setState({encoding:!1})};return p?f?React.createElement(He,{icon:Re.icon,label:"Cloudflare Stream",instructions:"Uploading your video.",className:"editor-media-placeholder"},React.createElement("div",{id:"progressbar-"+this.instanceId,style:{width:"100%"}},React.createElement("div",{className:"progress-label progress-label-"+this.instanceId},"Connecting...")),React.createElement(Ie,{variant:"tertiary",isDefault:!0,isLarge:!0,icon:"update",label:et("Retry"),onClick:h,style:{display:"none"},className:"editor-media-placeholder__retry-button"},et("Retry"))):d?React.createElement(He,{icon:Re.icon,label:"Cloudflare Stream",instructions:"Processing your video.",className:"editor-media-placeholder"},React.createElement("div",{id:"progressbar-"+this.instanceId,style:{width:"100%"}},React.createElement("div",{className:"progress-label progress-label-"+this.instanceId},"Connecting...")),React.createElement(Ie,{variant:"tertiary",isDefault:!0,isLarge:!0,icon:"update",label:et("Retry"),onClick:h,style:{display:"none"},className:"editor-media-placeholder__retry-button"},et("Retry"))):Re.api.key&&""!==Re.api.key?React.createElement(He,{icon:Re.icon,label:"Cloudflare Stream",instructions:"Select a file from your library."},React.createElement(Ne,{isLarge:!0,variant:"primary",multiple:!0,className:"editor-media-placeholder__upload-button",onChange:function(){var t=e.props.setAttributes;jQuery(".editor-media-placeholder .components-placeholder__instructions").html("Processing your video");var r=jQuery(".components-form-file-upload :input[type='file']")[0].files[0];t({file:r});var n=e;n.setState({editing:!0,uploading:!0,encoding:!1},(function(){jQuery("#progressbar-"+e.instanceId).progressbar({value:!1}),n.uploadFromFiles(r)}))},accept:"video/*"},et("Upload")),React.createElement(We,{type:"video",className:l,value:this.props.attributes,render:function(){return React.createElement(Ie,{variant:"secondary",isLarge:!0,label:et("Stream Library"),onClick:e.open,className:"editor-media-placeholder__browse-button"},et("Stream Library"))}}),React.createElement(Ie,{variant:"tertiary",isDefault:!0,isLarge:!0,label:et("Cancel"),onClick:m,style:{display:"none"},className:"editor-media-placeholder__cancel-button"},et("Cancel"))):React.createElement(He,{icon:Re.icon,label:"Cloudflare Stream",instructions:"Select a file from your library."},React.createElement(We,{type:"video",className:l,value:this.props.attributes,render:function(){return React.createElement(Ie,{isLarge:!0,variant:"secondary",label:et("Stream Library"),onClick:e.open,className:"editor-media-placeholder__browse-button"},et("Stream Library"))}}),React.createElement(Ie,{isDefault:!0,isLarge:!0,variant:"tertiary",label:et("Cancel"),onClick:m,style:{display:"none"},className:"editor-media-placeholder__cancel-button"},et("Cancel"))):React.createElement(Ge,null,React.createElement(Ke,null,React.createElement(Qe,{label:"Options"},React.createElement(Ie,{className:"components-icon-button components-toolbar__control",label:et("Edit video"),onClick:h,icon:"edit"}))),React.createElement(Je,null,React.createElement(qe,{title:et("Video Settings")},React.createElement(Me,{label:et("Autoplay"),onChange:this.toggleAttribute("autoplay"),checked:n}),React.createElement(Me,{label:et("Loop"),onChange:this.toggleAttribute("loop"),checked:i}),React.createElement(Me,{label:et("Muted"),onChange:this.toggleAttribute("muted"),checked:a}),React.createElement(Me,{label:et("Playback Controls"),onChange:this.toggleAttribute("controls"),checked:o}))),React.createElement("figure",{className:l},React.createElement(ze,{isDisabled:!u},React.createElement("iframe",{src:"https://iframe.videodelivery.net/"+r,controls:o,autoPlay:n,loop:i,muted:a,ref:this.streamPlayer}))))}}],r&&xe(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(Ve));const rt=Le(tt);var nt=wp.blob.createBlobURL,ot=wp.blocks.createBlock;const it={from:[{type:"files",isMatch:function(e){return 1===e.length&&0===e[0].type.indexOf("video/")},transform:function(e){var t=e[0];return ot("straightvisions/sv-cloudflare-stream",{src:nt(t)})}},{type:"shortcode",tag:"video",attributes:{src:{type:"string",shortcode:function(e){var t=e.named,r=t.src,n=t.mp4,o=t.m4v,i=t.webm,a=t.ogv,s=t.flv;return r||n||o||i||a||s}},poster:{type:"string",shortcode:function(e){return e.named.poster}},loop:{type:"string",shortcode:function(e){return e.named.loop}},autoplay:{type:"string",shortcode:function(e){return e.named.autoplay}},preload:{type:"string",shortcode:function(e){return e.named.preload}}}}]};var at=wp.blockEditor.useBlockProps;(0,wp.blocks.registerBlockType)("straightvisions/sv-cloudflare-stream",{title:"SV Cloudflare Stream",example:{attributes:{src:"https://upload.wikimedia.org/wikipedia/commons/c/ca/Wood_thrush_in_Central_Park_switch_sides_%2816510%29.webm",caption:(0,wp.i18n.__)("Wood thrush singing in Central Park, NYC.")}},transforms:it,edit:function(e){var t=at();return React.createElement("div",t,React.createElement(rt,e))},save:function(e){var r=e.attributes,n=r.autoplay,a=r.caption,s=r.controls,l=r.loop,u=r.muted,c=r.poster,p=r.preload,f=r.src,d=r.playsInline,h=r.tracks;return React.createElement("figure",i.save(),f&&React.createElement("video",{autoPlay:n,controls:s,loop:l,muted:u,poster:c,preload:"metadata"!==p?p:void 0,src:f,playsInline:d},React.createElement(t,{tracks:h})),!o.isEmpty(a)&&React.createElement(o.Content,{tagName:"figcaption",value:a}))}})})()})();